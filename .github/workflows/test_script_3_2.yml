# 工作流名称
name: Test dateutil parser

# 触发条件：push到main/develop分支、对main/develop分支的PR
on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

# 定义作业
jobs:
  test:
    # 运行环境：最新版Ubuntu
    runs-on: ubuntu-latest
    
    # 定义Python版本矩阵（可测试多个Python版本）
    strategy:
      fail-fast: false  # 一个版本失败不影响其他版本运行
      matrix:
        python-version: [3.8, 3.9, 3.10, 3.11]

    # 作业步骤
    steps:
      # 1. 拉取代码到运行环境
      - name: Checkout code
        uses: actions/checkout@v4

      # 2. 设置Python环境
      - name: Set up Python ${{ matrix.python-version }}
        uses: actions/setup-python@v5
        with:
          python-version: ${{ matrix.python-version }}
          # 缓存依赖，加速后续运行
          cache: 'pip'

      # 3. 安装依赖（pytest + python-dateutil）
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install pytest python-dateutil

      # 4. 运行测试脚本
      - name: Run tests
        run: |
          pytest test_script_3_2.py -v
